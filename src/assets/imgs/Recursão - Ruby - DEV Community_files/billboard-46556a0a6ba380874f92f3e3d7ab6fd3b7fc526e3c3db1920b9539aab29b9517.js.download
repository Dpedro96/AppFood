(()=>{function e(){let e=document.querySelectorAll("button[id^=sponsorship-dropdown-trigger-]");e.length&&e.forEach((e=>{t(e);let n=e.getAttribute("aria-controls");e&&"true"!==e.dataset.initialized&&(E({triggerElementId:e.id,dropdownContentId:n}),e.dataset.initialized="true")}));let n=document.querySelectorAll("button[id^=sponsorship-close-trigger-]");n.length&&n.forEach((e=>{e.addEventListener("click",(()=>{e.closest(".js-billboard").style.display="none"})),document.addEventListener("click",(t=>{t.target.closest(".js-billboard")||(e.closest(".js-billboard").style.display="none")}))}))}function t(e){e.closest(".js-billboard").clientHeight<220&&(e.closest(".js-billboard").style.overflowY="revert")}function n(e){let t,n,o,r,i,l=e.getElementsByTagName("script");for(i=0;i<l.length;i++)if(t=l[i],t){n=document.createElement("script");for(let e=0;e<t.attributes.length;e++)n.setAttribute(t.attributes[e].name,t.attributes[e].value);n.textContent=t.textContent,o=t.parentNode,r=t.nextSibling,o.removeChild(t),o.insertBefore(n,r)}}function o(e){if(e.querySelector(".js-billboard")&&"delayed"===e.querySelector(".js-billboard").dataset.special){e.classList.add("hidden");let t=new IntersectionObserver(i,{root:null,rootMargin:"-150px",threshold:.2}),n=document.getElementById("new_comment");t.observe(n)}}function r(){let e=new IntersectionObserver((e=>{e.forEach((e=>{if(e.isIntersecting){let t=e.target;e.intersectionRatio>=.25&&setTimeout((()=>{l(t)}),1)}}))}),{root:null,rootMargin:"0px",threshold:.25});document.querySelectorAll("[data-display-unit]").forEach((t=>{let n=window.location.pathname;e.observe(t),t.removeEventListener("click",a,!1),t.addEventListener("click",(()=>a(t,event,n)))}))}function i(e){e.forEach((e=>{e.isIntersecting&&document.querySelectorAll("[data-special='delayed']").forEach((e=>{e.closest(".hidden").classList.remove("hidden")}))}))}function l(e){let t=/bot|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex/i.test(navigator.userAgent),n=e.dataset.impressionRecorded;if(t||n)return;let o=document.querySelector("meta[name='csrf-token']"),r=o&&o.getAttribute("content"),i={billboard_event:{billboard_id:e.dataset.id,context_type:e.dataset.contextType,category:e.dataset.categoryImpression,article_id:e.dataset.articleId}};window.fetch("/billboard_events",{method:"POST",headers:{"X-CSRF-Token":r,"Content-Type":"application/json"},body:JSON.stringify(i),credentials:"same-origin"}).catch((e=>console.error(e))),e.dataset.impressionRecorded=!0}function a(e,t,n){if(!t.target.closest("a"))return;let o={billboard_event:{billboard_id:e.dataset.id,context_type:e.dataset.contextType,category:e.dataset.categoryClick,article_id:e.dataset.articleId}};localStorage&&(o.path=n,o.time=new Date,localStorage.setItem("last_interacted_billboard",JSON.stringify(o)));let r=/bot|google|baidu|bing|msn|duckduckbot|teoma|slurp|yandex/i.test(navigator.userAgent),i=e.dataset.clickRecorded;if(r||i)return;let l=document.querySelector("meta[name='csrf-token']"),a=l&&l.getAttribute("content");window.fetch("/billboard_events",{method:"POST",headers:{"X-CSRF-Token":a,"Content-Type":"application/json"},body:JSON.stringify(o),credentials:"same-origin"}),e.dataset.clickRecorded=!0}async function d(){let e=[...document.getElementsByClassName("js-billboard-container")].map(c);await Promise.all(e)}async function c(t){let{asyncUrl:i}=t.dataset,l=window.location.href.split("?")[1],a=localStorage.getItem("cookie_status");if(l&&l.includes("bb_test_placement_area")&&(i=`${i}?${l}`),"allowed"===a&&(i+=(i.includes("?")?"&":"?")+"cookies_allowed=true"),i)try{let l=await(await window.fetch(i)).text(),a=document.createElement("div");a.innerHTML=l,t.innerHTML="",t.appendChild(a),t.querySelectorAll("img").forEach((e=>{e.onerror=function(){this.style.display="none"}})),n(t),o(t),e(),r()}catch(e){/NetworkError/i.test(e.message)||Honeybadger.notify(e)}}var s=Object.create,u=Object.defineProperty,m=Object.getOwnPropertyDescriptor,f=Object.getOwnPropertyNames,p=Object.getPrototypeOf,g=Object.prototype.hasOwnProperty,b=(e,t,n,o)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let r of f(t))!g.call(e,r)&&r!==n&&u(e,r,{get:()=>t[r],enumerable:!(o=m(t,r))||o.enumerable});return e},y=(((e,t,n)=>{n=null!=e?s(p(e)):{},b(!t&&e&&e.__esModule?n:u(n,"default",{value:e,enumerable:!0}),e)})(((e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports))(((e,t)=>{function n(e,t,n){function r(t){var n=g,o=b;return g=b=void 0,x=t,v=e.apply(o,n)}function i(e){return x=e,I=setTimeout(s,t),j?r(e):v}function d(e){var n=t-(e-C);return k?E(n,y-(e-x)):n}function c(e){var n=e-C;return void 0===C||n>=t||n<0||k&&e-x>=y}function s(){var e=h();if(c(e))return u(e);I=setTimeout(s,d(e))}function u(e){return I=void 0,O&&g?r(e):(g=b=void 0,v)}function m(){void 0!==I&&clearTimeout(I),x=0,g=C=b=I=void 0}function f(){return void 0===I?v:u(h())}function p(){var e=h(),n=c(e);if(g=arguments,b=this,C=e,n){if(void 0===I)return i(C);if(k)return I=setTimeout(s,t),r(C)}return void 0===I&&(I=setTimeout(s,t)),v}var g,b,y,v,I,C,x=0,j=!1,k=!1,O=!0;if("function"!=typeof e)throw new TypeError(a);return t=l(t)||0,o(n)&&(j=!!n.leading,y=(k="maxWait"in n)?w(l(n.maxWait)||0,t):y,O="trailing"in n?!!n.trailing:O),p.cancel=m,p.flush=f,p}function o(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function r(e){return!!e&&"object"==typeof e}function i(e){return"symbol"==typeof e||r(e)&&v.call(e)==c}function l(e){if("number"==typeof e)return e;if(i(e))return d;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(s,"");var n=m.test(e);return n||f.test(e)?p(e.slice(2),n?2:8):u.test(e)?d:+e}var a="Expected a function",d=NaN,c="[object Symbol]",s=/^\s+|\s+$/g,u=/^[-+]0x[0-9a-f]+$/i,m=/^0b[01]+$/i,f=/^0o[0-7]+$/i,p=parseInt,g="object"==typeof window&&window&&window.Object===Object&&window,b="object"==typeof self&&self&&self.Object===Object&&self,y=g||b||Function("return this")(),v=Object.prototype.toString,w=Math.max,E=Math.min,h=function(){return y.Date.now()};t.exports=n}))()),'button, [href], input:not([type="hidden"]), select, textarea, [tabindex="0"]'),v=({triggerElementId:e,dropdownContentId:t})=>{var n;let o=document.getElementById(t);document.getElementById(e).setAttribute("aria-expanded","true"),o.style.display="block",null==(n=o.querySelector(y))||n.focus()},w=({triggerElementId:e,dropdownContentId:t,onClose:n})=>{var o;let r=document.getElementById(t);r&&(null==(o=document.getElementById(e))||o.setAttribute("aria-expanded","false"),r.style.removeProperty("display"),null==n||n())},E=({triggerElementId:e,dropdownContentId:t,dropdownContentCloseButtonId:n,onClose:o,onOpen:r})=>{var i;let l=document.getElementById(e),a=document.getElementById(t);if(!l||!a)return;l.setAttribute("aria-expanded","false"),l.setAttribute("aria-controls",t),l.setAttribute("aria-haspopup","true");let d=({key:n})=>{"Escape"===n?"true"===l.getAttribute("aria-expanded")&&(w({triggerElementId:e,dropdownContentId:t,onClose:s}),l.focus()):"Tab"===n&&(null!=a&&a.contains(document.activeElement)||w({triggerElementId:e,dropdownContentId:t,onClose:s}))},c=({target:n})=>{let o=document.getElementById(e);o&&n!==o&&!a.contains(n)&&!o.contains(n)&&(w({triggerElementId:e,dropdownContentId:t,onClose:s}),n.matches(y)||o.focus())},s=()=>{null==o||o(),document.removeEventListener("keyup",d),document.removeEventListener("click",c)};return l.addEventListener("click",(()=>{var n;"true"===(null==(n=document.getElementById(e))?void 0:n.getAttribute("aria-expanded"))?w({triggerElementId:e,dropdownContentId:t,onClose:s}):(v({triggerElementId:e,dropdownContentId:t}),null==r||r(),document.addEventListener("keyup",d),document.addEventListener("click",c))})),n&&(null==(i=document.getElementById(n))||i.addEventListener("click",(()=>{var n;w({triggerElementId:e,dropdownContentId:t,onClose:s}),null==(n=document.getElementById(e))||n.focus()}))),{closeDropdown:()=>{w({triggerElementId:e,dropdownContentId:t,onClose:s})}}};d()})();